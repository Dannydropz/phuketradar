Replit Plan: PhuketRadar.com â€“ Smart Translation + Story Classification System
Goal

Upgrade the PhuketRadar.com backend so it automatically:

Translates and rewrites Thai-language stories into English accurately and naturally.

Detects which stories are newsworthy (accidents, crime, weather, etc.) and prioritizes them for publication.

Filters out slow or boring stories (politics, meetings, ceremonies) from auto-publishing.

Keeps costs low using GPT-4o-mini and free Google Translate API.

Overview

The system should:

Use GPT-4o-mini (already configured) for translation and rewriting.

Add a hybrid logic:

Simple/short Thai â†’ handled directly by GPT-4o-mini.

Complex/long Thai â†’ translated first with free Google Translate â†’ then rewritten by GPT-4o-mini.

Add a classification layer that scores each story (1â€“5) for â€œreader interestâ€ and tags the category.

Only auto-publish stories with interest_score â‰¥ 4.

Queue the rest for review or daily digest.

1ï¸âƒ£ Create a Hybrid Translator

Create a file at:

utils/translator.js


Paste this code:

import OpenAI from "openai";
import translate from "@vitalets/google-translate-api";

const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

const contextMap = {
  "Patong": "a major tourist beach area on Phuketâ€™s west coast",
  "Kata": "a family-friendly beach known for surfing",
  "Rawai": "a local seafood area in southern Phuket",
  "Kamala": "a quiet beach community north of Patong",
  "Phuket Town": "the islandâ€™s cultural and administrative center",
  "Chalong": "a district known for the Big Buddha and pier area"
};

function isComplex(thaiText) {
  return thaiText.length > 400 || thaiText.includes("à¹à¸–à¸¥à¸‡") || thaiText.includes("à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ");
}

function enrichThaiText(thaiText) {
  let enriched = thaiText;
  for (const [key, value] of Object.entries(contextMap)) {
    if (enriched.includes(key)) {
      enriched = enriched.replace(key, `${key} (${value})`);
    }
  }
  return enriched;
}

export async function hybridTranslate(thaiText) {
  const enrichedText = enrichThaiText(thaiText);
  let englishSource;

  try {
    if (isComplex(thaiText)) {
      const result = await translate(enrichedText, { to: "en" });
      englishSource = result.text;
      console.log("ğŸŸ¢ Used Google Translate â†’ GPT-4o-mini");
    } else {
      englishSource = enrichedText;
      console.log("ğŸŸ¢ Used GPT-4o-mini direct translation");
    }

    const response = await client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        {
          role: "system",
          content: `You are an English news editor for Phuket Radar.
          Step 1: If text is Thai, translate accurately to English.
          Step 2: Rewrite for clarity and readability.
          Keep all names, times, places, and factual details.
          Add one short contextual line if useful (e.g., â€œPatong is a popular tourist areaâ€).
          Keep tone neutral and concise.`
        },
        { role: "user", content: englishSource }
      ],
      temperature: 0.3,
    });

    const rewritten = response.choices[0].message.content.trim();
    return rewritten;
  } catch (err) {
    console.error("Translation pipeline failed:", err);
    return null;
  }
}

2ï¸âƒ£ Create the News Classifier

Create a file at:

utils/classifier.js


Paste this code:

import OpenAI from "openai";
const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

const hotKeywords = ["à¸­à¸¸à¸šà¸±à¸•à¸´à¹€à¸«à¸•à¸¸","à¹„à¸Ÿà¹„à¸«à¸¡à¹‰","à¸ˆà¸¡à¸™à¹‰à¸³","à¸ˆà¸±à¸šà¸à¸¸à¸¡","à¸à¸²à¸¢à¸¸","à¸à¸™à¸•à¸à¸«à¸™à¸±à¸","à¹‚à¸ˆà¸£","à¹€à¸ªà¸µà¸¢à¸Šà¸µà¸§à¸´à¸•"];
const coldKeywords = ["à¸›à¸£à¸°à¸Šà¸¸à¸¡","à¸¡à¸­à¸šà¸«à¸¡à¸²à¸¢","à¸ªà¸±à¸¡à¸¡à¸™à¸²","à¹à¸–à¸¥à¸‡à¸‚à¹ˆà¸²à¸§","à¹‚à¸„à¸£à¸‡à¸à¸²à¸£","à¸­à¸šà¸£à¸¡","à¸¡à¸­à¸šà¸‚à¸­à¸‡"];

export async function classifyStory(englishText, thaiOriginal) {
  let keywordBoost = 0;
  if (hotKeywords.some(word => thaiOriginal.includes(word))) keywordBoost += 1;
  if (coldKeywords.some(word => thaiOriginal.includes(word))) keywordBoost -= 1;

  try {
    const prompt = `
    Classify this Phuket news story by topic and reader appeal.
    Return only JSON:
    {
      "category": one of ["Crime","Accident","Weather","Emergency","Tourism","Politics","Community","Event","Other"],
      "interest_score": integer 1-5,
      "headline_tone": one of ["Breaking","Developing","Routine"]
    }

    Scoring guide:
    - 5 = urgent or dramatic (crime, accident, drowning, storm, major closure)
    - 4 = important local info (traffic disruption, rescues, heavy rain alerts)
    - 3 = moderate (festivals, tourism, minor policy)
    - 2 = mundane (official meetings, community updates)
    - 1 = trivial (ceremonies, small events)

    Text:
    ${englishText}
    `;

    const response = await client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [{ role: "user", content: prompt }],
      temperature: 0.2,
    });

    const raw = response.choices[0].message.content.trim();
    const jsonStart = raw.indexOf("{");
    const jsonEnd = raw.lastIndexOf("}");
    const cleanJson = raw.slice(jsonStart, jsonEnd + 1);

    let data = JSON.parse(cleanJson);
    data.interest_score = Math.max(1, Math.min(5, data.interest_score + keywordBoost));
    data.publishNow = data.interest_score >= 4;
    return data;
  } catch (err) {
    console.error("Classification failed:", err);
    return { category: "Unknown", interest_score: 3, headline_tone: "Routine", publishNow: false };
  }
}

3ï¸âƒ£ Integrate into Main Pipeline

In your main story-processing script, add:

import { hybridTranslate } from "./utils/translator.js";
import { classifyStory } from "./utils/classifier.js";

async function processStory(thaiText) {
  const englishText = await hybridTranslate(thaiText);
  const meta = await classifyStory(englishText, thaiText);

  console.log("âœ… Classified story:", meta);

  if (meta.publishNow) {
    await publishToSite(englishText, meta.category, meta.interest_score);
  } else {
    await queueForReview(englishText, meta.category);
  }
}

4ï¸âƒ£ Behavior Summary

âœ… High-interest stories (score â‰¥ 4) â†’ auto-publish instantly.
âœ… Mid-level stories (score 3) â†’ held for manual review.
âœ… Low-interest (score â‰¤ 2) â†’ archived silently.
âœ… Built-in keyword booster ensures â€œà¹„à¸Ÿà¹„à¸«à¸¡à¹‰â€, â€œà¸ˆà¸±à¸šà¸à¸¸à¸¡â€, â€œà¸à¸™à¸•à¸à¸«à¸™à¸±à¸â€, etc. get priority.

5ï¸âƒ£ Optional Add-Ons (Future Phases)

Add a â€œheadline generatorâ€ that uses the same classification metadata.

Store interest_score and category in Supabase for analytics dashboards.

Weekly fine-tuning: Feed GPT examples of what Phuket Radar did or didnâ€™t post to refine tone.

âœ… Expected Outcome

PhuketRadar.com automatically filters and publishes only the fast, dramatic, and relevant stories that matter â€” crime, weather, rescues, and local incidents â€” keeping the brand sharp, engaging, and truly â€œPhuketâ€™s Fastest English Breaking News.â€